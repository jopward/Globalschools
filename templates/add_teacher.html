{% extends "base.html" %}

{% block content %}
<div class="container">
    <h3 class="mb-4 text-center">📚 إدارة المعلمين</h3>

    <!-- رسائل الفلاش -->
    {% with messages = get_flashed_messages() %}
      {% if messages %}
        <div class="alert alert-success text-center">
          {% for message in messages %}
            <p>{{ message }}</p>
          {% endfor %}
        </div>
      {% endif %}
    {% endwith %}

    <!-- نموذج إضافة معلم -->
    <div class="card mb-4 shadow-sm">
        <div class="card-header bg-primary text-white">
            <strong>➕ إضافة معلم جديد</strong>
        </div>
        <div class="card-body">
            <form method="POST" action="{{ url_for('user_bp.add_teacher_page') }}">
                <div class="row mb-3">
                    <div class="col-md-6">
                        <label class="form-label">اسم المعلم</label>
                        <input type="text" name="name" class="form-control" placeholder="اكتب اسم المعلم" required>
                    </div>
                    <div class="col-md-6">
                        <label class="form-label">اسم المستخدم</label>
                        <input type="text" name="username" class="form-control" placeholder="اسم المستخدم" required>
                    </div>
                </div>
                
                <div class="row mb-3">
                    <div class="col-md-6">
                        <label class="form-label">كلمة المرور</label>
                        <input type="password" name="password" class="form-control" placeholder="كلمة المرور" required>
                    </div>
                    <div class="col-md-6">
                        <label class="form-label">رمز المعلم (اختياري)</label>
                        <input type="text" name="teacher_code" class="form-control" placeholder="مثلاً: T123">
                    </div>
                </div>

                <button type="submit" class="btn btn-success px-4">إضافة المعلم</button>
            </form>
        </div>
    </div>

    <!-- جدول عرض المعلمين -->
    <div class="card shadow-sm">
        <div class="card-header bg-secondary text-white">
            <strong>🧑‍🏫 قائمة المعلمين</strong>
        </div>
        <div class="card-body p-0">
            <table class="table table-striped table-bordered mb-0 text-center align-middle">
                <thead class="table-dark">
                    <tr>
                        <th>#</th>
                        <th>اسم المعلم</th>
                        <th>اسم المستخدم</th>
                        <th>رمز المعلم</th>
                        <th>إجراءات</th>
                    </tr>
                </thead>
                <tbody>
                    {% if teachers and teachers|length > 0 %}
                        {% for teacher in teachers %}
                        <tr>
                            <td>{{ loop.index }}</td>
                            <td>{{ teacher.name }}</td>
                            <td>{{ teacher.username }}</td>
                            <td>{{ teacher.teacher_code or "-" }}</td>
                            <td>
                                <a href="{{ url_for('user_bp.edit_teacher', user_id=teacher.id) }}" 
                                   class="btn btn-warning btn-sm">
                                    ✏️ تعديل
                                </a>
                                <a href="{{ url_for('user_bp.delete_teacher', user_id=teacher.id) }}" 
                                   class="btn btn-danger btn-sm" 
                                   onclick="return confirm('هل أنت متأكد من حذف هذا المعلم؟');">
                                    🗑️ حذف
                                </a>
                            </td>
                        </tr>
                        {% endfor %}
                    {% else %}
                        <tr>
                            <td colspan="5" class="text-muted py-3">لا يوجد معلمون مضافون بعد.</td>
                        </tr>
                    {% endif %}
                </tbody>
            </table>
        </div>
    </div>
</div>
{% endblock %}
